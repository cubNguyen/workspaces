<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="https://unpkg.com/tabulator-tables@5.5.0/dist/css/tabulator.css" />
        <!--  -->
        <script type="text/javascript" src="https://code.jquery.com/jquery-3.7.0.js"></script>
        <!-- <script type="text/javascript" src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script> -->

        <!--  -->
        <script type="text/javascript" src="https://unpkg.com/tabulator-tables@5.5.0/dist/js/tabulator.js"></script>
        <!-- <script type="text/javascript" src="https://unpkg.com/tabulator-tables@5.5.0/dist/js/jquery_wrapper.js"></script> -->

        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
        <!-- <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script> -->

        <script type="text/javascript" src="https://oss.sheetjs.com/sheetjs/xlsx.full.min.js"></script>

        <style>
            .tabulator-row.tabulator-group {
                position: -webkit-sticky;
                position: sticky;
                top: 0;
                z-index: 1000;
            }

            .tabulator-row.tabulator-group:hover {
                background: #eaeaea; /* Default hover background has an opacity: rgba(0,0,0,.1) */
            }
        </style>
    </head>
    <body>
        <pre>
            Refs:
            - freeze/sticky group headers: https://codepen.io/izmirli/pen/zYPVBxq
           
            Note:
            - Need Render Buffer to make smooth scrolling (https://tabulator.info/docs/5.5/layout#virtual-dom-buffer)
        </pre>
        <hr />
        <button id="download-xlsx">Download XLSX</button>
        <br />
        <div id="example-table"></div>

        <script>
            $(document).ready(function () {
                //trigger download of data.xlsx file
                document.getElementById('download-xlsx').addEventListener('click', function () {
                    table.download('xlsx', 'data.xlsx');
                });
            });

            var tableDataNested = [
                {
                    name: '',
                    location: 'group of France',
                    gender: '1.0',
                    col: '2.0',
                    dob: '3.0',
                    _children: [
                        { name: 'Christine Lobowski', location: 'France', gender: 'female', col: 'green', dob: '22/05/1982' },
                        { name: 'Christine Lobowski', location: 'France', gender: 'female', col: 'green', dob: '22/05/1982' },
                        { name: 'Christine Lobowski', location: 'France', gender: 'female', col: 'green', dob: '22/05/1982' },
                        { name: 'Christine Lobowski', location: 'France', gender: 'female', col: 'green', dob: '22/05/1982' },
                        { name: 'Christine Lobowski', location: 'France', gender: 'female', col: 'green', dob: '22/05/1982' },
                        { name: 'Christine Lobowski', location: 'France', gender: 'female', col: 'green', dob: '22/05/1982' },
                        { name: 'Christine Lobowski', location: 'France', gender: 'female', col: 'green', dob: '22/05/1982' },
                        { name: 'Christine Lobowski', location: 'France', gender: 'female', col: 'green', dob: '22/05/1982' },
                    ],
                },
                {
                    name: '',
                    location: 'group of South Korea',
                    gender: '110',
                    col: '120',
                    dob: '130',
                    _children: [
                        { name: 'Emily Sykes', location: 'South Korea', gender: 'female', col: 'maroon', dob: '11/11/1970' },
                        { name: 'Emily Sykes', location: 'South Korea', gender: 'female', col: 'maroon', dob: '11/11/1970' },
                        { name: 'Emily Sykes', location: 'South Korea', gender: 'female', col: 'maroon', dob: '11/11/1970' },
                        { name: 'Emily Sykes', location: 'South Korea', gender: 'female', col: 'maroon', dob: '11/11/1970' },
                        { name: 'Emily Sykes', location: 'South Korea', gender: 'female', col: 'maroon', dob: '11/11/1970' },
                        { name: 'Emily Sykes', location: 'South Korea', gender: 'female', col: 'maroon', dob: '11/11/1970' },
                        { name: 'Emily Sykes', location: 'South Korea', gender: 'female', col: 'maroon', dob: '11/11/1970' },
                        { name: 'Emily Sykes', location: 'South Korea', gender: 'female', col: 'maroon', dob: '11/11/1970' },
                        { name: 'Emily Sykes', location: 'South Korea', gender: 'female', col: 'maroon', dob: '11/11/1970' },
                    ],
                },
            ];

            //
            var table = new Tabulator('#example-table', {
                height: '611px',
                data: tableDataNested,
                dataTree: true,
                dataTreeStartExpanded: true,
                // dataTreeCollapseElement: '<div></div>',
                // dataTreeExpandElement: '<div></div>',
                dataTreeBranchElement: false, //hide branch element
                // dataTreeChildIndent: 15, //indent child rows by 15 px
                dataTreeElementColumn: "location", //insert the collapse/expand toggle element in the name column
                columns: [
                    { title: 'Name', field: 'name', width: 200, responsive: 0 }, //never hide this column
                    { title: 'Location', field: 'location', width: 150 },
                    { title: 'Gender', field: 'gender', width: 150, responsive: 2 }, //hide this column first
                    { title: 'Favourite Color', field: 'col', width: 150 },
                    { title: 'Date Of Birth', field: 'dob', hozAlign: 'center', sorter: 'date', width: 150 },
                ],
            });
        </script>
    </body>
</html>
