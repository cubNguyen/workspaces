<!DOCTYPE html>
<html>
    <head>
        <link href="https://unpkg.com/tabulator-tables@5.5/dist/css/tabulator.min.css" rel="stylesheet" />
        <script type="text/javascript" src="https://unpkg.com/tabulator-tables@5.5/dist/js/tabulator.min.js"></script>
        <script type="text/javascript" src="https://code.jquery.com/jquery-3.7.0.slim.min.js" integrity="sha256-tG5mcZUtJsZvyKAxYLVXrmjKBVLd6VpVccqz/r4ypFE=" crossorigin="anonymous"></script>
        <style>
            .tabulator-table .tabulator-row.selecting {
                background-color: #bbb;
            }

            .tabulator-table .tabulator-row .tabulator-cell .row-span{
                background-color: antiquewhite;
                position: fixed;
                z-index: 10;
                margin: -4px;
                padding: 3px;
                border: 1px solid;
                display: flex;
                align-items: center;
                /* justify-content: center; */
            }
        </style>
    </head>
    <body>
        <div id="example-table"></div>

        <script>

            var customRowHeight = 28;
            var data = [
                { col1: '123 1', col2: 'eryt 2', col3: '06/27' },
                { col1: '456 1', col2: 'gfhj 2', col3: '3' },
                { col1: '789 1', col2: 'cvbn 2', col3: '3' },
                { col1: '789 1', col2: 'cvbn 2', col3: '3' },
                { col1: '789 1', col2: 'cvbn 2', col3: '3' },
                { col1: '123 1', col2: 'eryt 2', col3: '06/27' },
                { col1: '456 1', col2: 'gfhj 2', col3: '3' },
                { col1: '789 1', col2: 'cvbn 2', col3: '3' },
                { col1: '789 1', col2: 'cvebn 2', col3: '3' },
                { col1: '789 1', col2: 'cvgbn 2', col3: '3' },
                { col1: '123 1', col2: 'eryt 2', col3: '06/27' },
                { col1: '456 1', col2: 'gfhj 2', col3: '3' },
                { col1: '789 1', col2: 'cvbn 2', col3: '3' },
                { col1: '789 1', col2: 'cvben 2', col3: '3' },
                { col1: '789 1', col2: 'cvgbn 2', col3: '3' },
                { col1: '123 1', col2: 'eryt 2', col3: '06/27' },
                { col1: '456 1', col2: 'gfhj 2', col3: '3' },
                { col1: '789 1', col2: 'cvben 2', col3: '3' },
                { col1: '789 1', col2: 'cvbgn 2', col3: '3' },
                { col1: '789 1', col2: 'cvbn 2', col3: '3' },
                { col1: '123 1', col2: 'eryt 2', col3: '06/27' },
                { col1: '456 1', col2: 'gfhj 2', col3: '3' },
                { col1: '789 1', col2: 'cvbn 2', col3: '3' },
                { col1: '789 1', col2: 'cvbn 2', col3: '3' },
                { col1: '789 1', col2: 'cvbn 2', col3: '3' },
                { col1: '123 1', col2: 'eryt 2', col3: '06/27' },
                { col1: '456 1', col2: 'gfhj 2', col3: '3' },
                { col1: '789 1', col2: 'cvbn 2', col3: '3' },
                { col1: '789 1', col2: 'cvbn 2', col3: '3' },
                { col1: '789 1', col2: 'cvbn 2', col3: '3' },
                { col1: '123 1', col2: 'eryt 2', col3: '06/27' },
                { col1: '456 1', col2: 'gfhj 2', col3: '3' },
                { col1: '789 1', col2: 'cvbn 2', col3: '3' },
                { col1: '789 1', col2: 'cvbn 2', col3: '3' },
                { col1: '789 1', col2: 'cvbn 2', col3: '3' },
                { col1: '123 1', col2: 'eryt 2', col3: '06/27' },
                { col1: '456 1', col2: 'gfhj 2', col3: '3' },
                { col1: '789 1', col2: 'cvbn 2', col3: '3' },
                { col1: '789 1', col2: 'cvbn 2', col3: '3' },
                { col1: '789 1', col2: 'cvbn 2', col3: '3' },
                { col1: '123 1', col2: 'eryt 2', col3: '06/27' },
                { col1: '456 1', col2: 'gfhj 2', col3: '3' },
                { col1: '789 1', col2: 'cvbn 2', col3: '3' },
                { col1: '789 1', col2: 'cvbn 2', col3: '3' },
                { col1: '789 1', col2: 'cvbn 2', col3: '3' },
            ];

            function customFormatter (cell, formatterParams, onRendered){
                //cell - the cell component
                //formatterParams - parameters set for the column
                //onRendered - function to call when the formatter has been rendered

                onRendered(function(){
                    let rowSpanEle = cell.getElement().querySelector('.row-span');
                    rowSpanEle.style.width = (cell.getElement().offsetWidth - 8 - 1) + 'px';

                    // Prev row
                    let prevRow = cell.getRow().getPrevRow();
                    if(prevRow){
                        let prevRowVal = prevRow.getCell(cell.getField()).getValue();
                        if(cell.getValue() == prevRowVal){
                            rowSpanEle.style.display = 'none';
                            return;
                        }
                    }
                    
                    // Next row
                    let rowSpanCnt = 1;
                    let nextRow = cell.getRow().getNextRow();
                    if(nextRow){
                        let nextRowVal = nextRow.getCell(cell.getField()).getValue();
                        while(cell.getValue() == nextRowVal) {
                            rowSpanCnt += 1;
                            nextRow = nextRow.getNextRow();
                            if(nextRow){
                                nextRowVal = nextRow.getCell(cell.getField()).getValue();
                            } else {
                                break;
                            }
                        }
                    }

                    // Set height
                    rowSpanEle.style.height = (customRowHeight * rowSpanCnt - 8)  + 'px';
                });

                let tagDiv = document.createElement('div');
                tagDiv.className = 'row-span';
                tagDiv.innerText = cell.getValue();
                
                return tagDiv ; //return the contents of the cell;
            }
            
            var table = new Tabulator('#example-table', {
                layout:"fitDataTable",
                //
                pagination: 'local',
                paginationSize: 10,
                // paginationButtonCount: 0,
                // 
                rowHeight: customRowHeight,
                rowFormatter: function(row){
                    //row - row component
                    row.reformat();
                },
                // 
                columns: [
                    { title: 'CHK', formatter: 'rowSelection', titleFormatter: 'rowSelection', headerSort: false },
                    {
                        title: 'can edit orgin',
                        field: 'col2',
                        width: 200,
                        // headerFilter: 'input',
                    },
                    {
                        title: 'can edit',
                        field: 'col2',
                        width: 200,
                        headerFilter: 'input',
                        formatter: customFormatter,
                    },
                    {
                        title: 'cant edit',
                        field: 'col1',
                        width: 200,
                    },
                    {
                        title: 'double click',
                        field: 'col3',
                        width: 200,
                    },
                ],
                data: data,
                // selectable: false,
            });

            $(document).ready(function () {
                table.on("rowClick", function(e, row){
                    $('.tabulator-table .tabulator-row.selecting').removeClass('selecting');
                    // row.toggleSelect();
                    row.getElement().classList.add('selecting');
                });
            });
        </script>
    </body>
</html>
